<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tip Calculator</title>
</head>
<body>
    <h1>Tip Calculator</h1>
    
    <label for="billAmount">Enter your bill amount:</label>
    <input type="number" id="billAmount" placeholder="Bill Amount" />
    <button type="button" onclick="resetForm()">Reset</button>

<style>
.tip-btn, .service-btn, .food-btn {
    background-color: #f0f0f0;
    border: 1px solid #ddd;
    padding: 10px;
    margin-right: 5px;
}

.tip-btn.selected, .service-btn.selected, .food-btn.selected  {
    background-color: #007bff;
    color: white;
    border-color: #0056b3;
}

.checkbox-group label {
    display: block;
    margin-top: 10px;
}
</style>   

    <p>Select tip percentage:</p>
    <button class="tip-btn" data-value="15" onclick="setTipPercentage(15)">15%</button>
    <button class="tip-btn" data-value="18" onclick="setTipPercentage(18)">18%</button>
    
    <p>Based on <b>service quality</b>, add:</p>
    <button class="service-btn" data-value="-3"  onclick="adjustTip(-3)">-3%</button>
    <button class="service-btn" data-value="-2"  onclick="adjustTip(-2)">-2%</button>
    <button class="service-btn" data-value="-1"  onclick="adjustTip(-1)">-1%</button>
    <button class="service-btn" data-value="0"  onclick="adjustTip(0)">0%</button>
    <button class="service-btn" data-value="1"  onclick="adjustTip(1)">+1%</button>
    <button class="service-btn" data-value="2"  onclick="adjustTip(2)">+2%</button>
    <button class="service-btn" data-value="3"  onclick="adjustTip(3)">+3%</button>

    <p>Based on <b>food quality</b>, add:</p>
    <button class="food-btn" data-value="-3" onclick="adjustForFoodQuality(-3)">-3%</button>
    <button class="food-btn" data-value="-2" onclick="adjustForFoodQuality(-2)">-2%</button>
    <button class="food-btn" data-value="-1" onclick="adjustForFoodQuality(-1)">-1%</button>
    <button class="food-btn" data-value="0" onclick="adjustForFoodQuality(0)">0%</button>
    <button class="food-btn" data-value="1" onclick="adjustForFoodQuality(1)">+1%</button>
    <button class="food-btn" data-value="2" onclick="adjustForFoodQuality(2)">+2%</button>
    <button class="food-btn" data-value="3" onclick="adjustForFoodQuality(3)">+3%</button>

    <p></p>
    
    <div class="checkbox-group">
        <label>
            <input type="checkbox" id="suggestTip" onchange="updateTipModifiers()" />
            If suggested tip after tax (deduct %):
            <input type="number" id="suggestTipValue" placeholder="5" disabled value="5" onchange="updateTipModifiers()" />
        </label>
        <label>
            <input type="checkbox" id="other" onchange="updateTipModifiers()" />
            Other (deduct %):
            <input type="number" id="otherValue" placeholder="5" disabled value="5" onchange="updateTipModifiers()" />
        </label>
    </div>

    
    <h2>Final Tip Percentage: <span id="finalTipPercentage">0</span>%</h2>
    <h2>Tip Amount: $<span id="tipAmount">0.00</span></h2>
    <h2>Total Bill: $<span id="totalBill">0.00</span></h2>

    <script>
        var baseTipPercentage = 0;
        var serviceTipPercentage = 0;
        var foodQualityPercentage = 0;
        var additionalDeductions = 0; // To store deductions from checkboxes
    
        function setTipPercentage(percent) {
            baseTipPercentage = percent;
            serviceTipPercentage = 0;
            foodQualityPercentage = 0;
            additionalDeductions = 0; // Reset any deductions from checkboxes
            updateButtonStyles(percent, 'tip-btn');
            resetButtons('service-btn');
            resetButtons('food-btn');
            clearCheckboxes(); // Reset checkboxes
            calculateTip();
        }
    
        function adjustTip(additionalPercent) {
            serviceTipPercentage = additionalPercent;
            updateButtonStyles(additionalPercent, 'service-btn');
            calculateTip();
        }
    
        function adjustForFoodQuality(additionalPercent) {
            foodQualityPercentage = additionalPercent;
            updateButtonStyles(additionalPercent, 'food-btn');
            calculateTip();
        }
    
        function updateButtonStyles(selectedValue, className) {
            var buttons = document.getElementsByClassName(className);
            Array.from(buttons).forEach(button => {
                button.classList.remove('selected');
                var value = parseInt(button.dataset.value);
                if (value === selectedValue) {
                    button.classList.add('selected');
                }
            });
        }
    
        function resetButtons(className) {
            var buttons = document.getElementsByClassName(className);
            Array.from(buttons).forEach(button => {
                button.classList.remove('selected');
            });
        }
    
        function clearCheckboxes() {
            ['suggestTip', 'other'].forEach(function(checkboxId) {
                var checkbox = document.getElementById(checkboxId);
                var input = document.getElementById(checkboxId + 'Value');
                checkbox.checked = false;
                input.disabled = true;
                input.value = ''; // Clear the input field
            });
            additionalDeductions = 0; // Reset additional deductions
        }
    
        function updateTipModifiers() {
            additionalDeductions = 0; // Reset additional deductions
            ['suggestTip', 'other'].forEach(function(checkboxId) {
                var checkbox = document.getElementById(checkboxId);
                var input = document.getElementById(checkboxId + 'Value');
                if (checkbox.checked) {
                    input.disabled = false;
                    additionalDeductions -= parseFloat(input.value) || 0;
                } else {
                    input.disabled = true; // Disable the input if the checkbox is unchecked
                }
            });
            calculateTip();
        }
    
        function calculateTip() {
            var billAmount = parseFloat(document.getElementById('billAmount').value) || 0;
            var totalTipPercentage = baseTipPercentage + serviceTipPercentage + foodQualityPercentage + additionalDeductions;
            var tipAmount = billAmount * (totalTipPercentage / 100);
            var totalBill = billAmount + tipAmount;
    
            document.getElementById('finalTipPercentage').textContent = totalTipPercentage.toFixed(0);
            document.getElementById('tipAmount').textContent = tipAmount.toFixed(2);
            document.getElementById('totalBill').textContent = totalBill.toFixed(2);
        }

        function resetForm() {
            document.getElementById('billAmount').value = '';
            baseTipPercentage = 0;
            serviceTipPercentage = 0;
            foodQualityPercentage = 0;
            additionalDeductions = 0;
            resetButtons('tip-btn');
            resetButtons('service-btn');
            resetButtons('food-btn');
            ['suggestTip', 'other'].forEach(function(checkboxId) {
                var checkbox = document.getElementById(checkboxId);
                var input = document.getElementById(checkboxId + 'Value');
                checkbox.checked = false;
                input.value = '';
                input.disabled = true;
            });
            document.getElementById('finalTipPercentage').textContent = '0';
            document.getElementById('tipAmount').textContent = '$0.00';
            document.getElementById('totalBill').textContent = '$0.00';
}
    </script>
</body>
</html>